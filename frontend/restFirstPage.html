<!DOCTYPE html>
<html>

<head>
<link href="https://fonts.googleapis.com/css?family=Source Code Pro" rel="stylesheet">

<style>
body{
  background-image: url("https://www.natrajindiancuisinevietnam.com/img/slider/slide01.jpg");   
  background-size: cover;  
  margin: 0;
    }
    
table { 
  border-collapse: collapse;
  height: 500px;
  display: inline-block; 
  overflow: auto;

}
input[type="button"] {
  font-family: "Source Code Pro";
  width: 100%;
  background: #cc6666;
  border-radius: 3px;
  border: 0;
  cursor: pointer;
  color: white;
  font-size: 18px;
  padding-top: 10px;
  padding-bottom: 10px;
  transition: all 0.3s;
  margin-top: -4px;
  font-weight: 200;
  display: block;
  float: none;
  text-align: center;
}
input[type="button"]:hover {
  background: #cc4949;
}


</style>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 

<script>

     function changeValue(itemNum, newValue) {
            if ((itemNum != null) && (newValue != null)) {
            document.getElementById("item" + itemNum + "_newPrice").textContent = newValue.toPrecision(3);
          }
          }

      function updateDiscount(itemNum, quantity, discountVal) {
          const url = "/updateDiscount";
          data = {
            itemNum: itemNum,
            quantity: quantity,
            discountVal: discountVal
          }

          // source:https://www.freecodecamp.org/news/here-is-the-most-popular-ways-to-make-an-http-request-in-javascript-954ce8c95aaa/
          $.post(url, data)
            .done(function(data) { 
              changeValue(data.itemNum, data.discountVal)
            })
      }

      function applyDiscount(itemNum) {
          if (itemNum != null) {
              var discount = document.getElementById("item" + itemNum + "_discount").value;
              var quantity = document.getElementById("item" + itemNum + "_quantity").value;
          } 

          updateDiscount(itemNum, parseInt(quantity), parseFloat(discount));
      }

</script>

</head>

  <head>
  <title>Chennai Chimney</title> 
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="static/table.css" type="text/css">
    <ul class="topnav">
        <li><a class="active" href="/restabout"><span class="vertical"><b>Re</b></span>Eats</a></li>
        <li class="right"><a href="/logout">Logout</a></li>
        <li class="right"><a href="/restFeedback">Feedback</a></li>
        <li class="right"><a href="/restDiscount">Discounts</a></li>
        <li class="right"><a href="/restAccount">Account</a></li>
        <li class="right"><a href="/restFP">Menu</a></li>           
    </ul>
  </head>

  <body>
    <div class="title" >

    <hr style="background-color: #1e1e28">

    
 <!--    <form action="/" method="get">
        <label for="restName"></label><br> -->
        <center>
        <label><strong>Chennai Chimney
            </strong></label></center>
      
<!--     </form> -->

    <hr color ="black">
     </div>
    <center>
    <table cellspacing="1" cellpadding="1" style = "align:center">  
      <!-- align:"center" -->
      <tr>
          <th><strong><div>Food Item</div></strong></th>
          <th><strong><div>Description</div></strong></th>
          <th><strong><div>List Price</div></strong></th>
          <th><strong><div>Quantity</div></strong></th>
          <th><strong><div>Discount</div></strong></th>
          <th><strong><div>Discounted Price</div></strong></th>

            </tr>

      {% for item in restaurant %}
        <tr>
          <td>{{ item.getFood()}}</td>
          <td>{{ item.getDescription()}}</td>
          <script>
            var {id} = item.getId()
          </script>
          <td id="item{{item.getId()}}_price" value={{item.getPrice()}}> {{item.getPrice() }} </td>
          <td>
            <label for="quantity"></label><br>
            <input align = "right" style="width:70%"  type="text" id="item{{item.getId()}}_quantity" name="quantity" ><br><br>
          </td>
          <td>
              <label for="discount"></label><br>
              <input align = "right" style="width:70%" type="text" id="item{{item.getId()}}_discount" name="discount" ><br><br>
          </td>
          <td> 
            <input align = "right" type="button" 
            onclick= "applyDiscount({{item.getId()}})" id="submit" name= "submit" value="Apply">
            <label id="item{{item.getId()}}_newPrice" value="{{newPrice}}"> </label>
          </td>
        </tr>

      {% endfor %}

        </table></center>
  </body>
</html>